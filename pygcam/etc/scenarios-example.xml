<?xml version="1.0" encoding="UTF-8"?>
<!-- Example of XML setup "script"

     The iterators are used to expand the scenarioGroup and scenario
     elements that reference them, and the top-level run method
     executes the steps defined here for the given group and scenario.
-->

<setup name="uniqueName" defaultGroup="protect-0.0"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xsi:noNamespaceSchemaLocation="scenarios-schema.xsd">

    <!-- Results in the set {'0.0', '0.2', '0.4', '0.6', '0.8', '1.0'} -->
    <iterator name="fraction" type="float" min="0.0" max="1.0" step="0.2" format="%.1f"/>

    <!-- step="1" is default for int type. Yields {'1', '2', '3', '4', '5'} -->
    <iterator name="sspnum" type="int" min="1" max="5"/>

    <iterator name="letter" type="list" values="a,b ,c "/>

    <scenarioGroup name="protect-{fraction}" useGroupDir="0" iterator="fraction">

        <scenario name="base-{fraction}-ssp-{sspnum}" baseline="1" iterator="sspnum">
            <!--
             <function> allows certain methods of the XMLEditor class to be called
             by passing comma-separated arguments in the text, just as they would
             be written inside the parentheses of a function call
             -->
            <function name="protectLand">{fraction}, otherArable=False, unprotectFirst=True</function>
            <function name="setClimateOutputInterval">2</function>

            <!-- Delete scenario elements in the file by their "name" tag -->
            <delete name="protected_land_input_2"/>
            <delete name="protected_land_input_3"/>

            <!--
            The variable {scenarioDir} is defined dynamically to be a relative path (from
            the "exe" directory, where GCAM is run) to the scenario's dir under local-xml.
            -->
            <replace name="cement_2">{scenarioDir}/cement_incelas_ssp{sspnum}.xml</replace>
            <replace name="industry_2">{scenarioDir}/industry_incelas_ssp{sspnum}.xml</replace>
            <replace name="socioeconomics_2">{scenarioDir}/socioeconomics_ssp{sspnum}.xml</replace>

            <!-- Replace standard file with modified version -->
            <replace name="transportation">{scenarioDir}/transportation_custom.xml</replace>

            <!-- add these new files at the end -->
            <add name="energy_USSugar">{scenarioDir}/USSugarEthanol.xml</add>
            <add name="energy_USPalm">{scenarioDir}/USPalmBioDiesel.xml</add>
        </scenario>

        <!-- By default, active="1"; set it to "0" to deactivate -->
        <scenario name="corn-{fraction}-ssp-{sspnum}" iterator="sspnum" active="0">
            <!-- <insert> adds an element after the element with the given name  -->
            <insert name="whatever" after="cement_2">{scenarioDir}/corn-specific-file.xml</insert>
        </scenario>

        <scenario name="foo-{fraction}-{letter}" iterator="letter">
            <insert name="something" after="cement_2">{scenarioDir}/foo-bar-baz.xml</insert>
        </scenario>
    </scenarioGroup>
</setup>
