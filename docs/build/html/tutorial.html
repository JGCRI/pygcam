

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Tutorial – Using pygcam &mdash; pygcam 0.1a1 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="pygcam 0.1a1 documentation" href="index.html"/>
        <link rel="next" title="project.xml" href="project-xml.html"/>
        <link rel="prev" title="gt (GCAM tool)" href="gcamtool.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> pygcam
          

          
          </a>

          
            
            
              <div class="version">
                0.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul>
<li class="toctree-l1"><a class="reference internal" href="intro.html">Introduction to <code class="docutils literal"><span class="pre">pygcam</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="windows.html">Using pygcam under Windows</a></li>
<li class="toctree-l1"><a class="reference internal" href="setup.html">GCAM XML-Setup</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="gcamtool.html"><code class="docutils literal"><span class="pre">gt</span></code> (GCAM tool)</a></li>
</ul>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="">Tutorial &#8211; Using <code class="docutils literal"><span class="pre">pygcam</span></code></a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="project-xml.html">project.xml</a></li>
<li class="toctree-l1"><a class="reference internal" href="query-xml.html">queries.xml</a></li>
<li class="toctree-l1"><a class="reference internal" href="query-xml.html#rewritesets-xml">rewriteSets.xml</a></li>
<li class="toctree-l1"><a class="reference internal" href="landProtection-xml.html">landProtection.xml</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="utils.html"><code class="docutils literal"><span class="pre">pygcam.common</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="config.html"><code class="docutils literal"><span class="pre">pygcam.config</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="diff.html"><code class="docutils literal"><span class="pre">pygcam.diff</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="error.html"><code class="docutils literal"><span class="pre">pygcam.error</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="landProtection.html"><code class="docutils literal"><span class="pre">pygcam.landProtection</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="log.html"><code class="docutils literal"><span class="pre">pygcam.log</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="project.html"><code class="docutils literal"><span class="pre">pygcam.project</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="query.html"><code class="docutils literal"><span class="pre">pygcam.query</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="subcommand.html"><code class="docutils literal"><span class="pre">pygcam.subcommand</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="xmlEditor.html"><code class="docutils literal"><span class="pre">pygcam.xmlEditor</span></code></a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">pygcam</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          





<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>
      
    <li>Tutorial &#8211; Using <code class="docutils literal"><span class="pre">pygcam</span></code></li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/tutorial.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="tutorial-using-pygcam">
<h1>Tutorial &#8211; Using <code class="docutils literal"><span class="pre">pygcam</span></code><a class="headerlink" href="#tutorial-using-pygcam" title="Permalink to this headline">¶</a></h1>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last"><em>This tutorial is currently under development.</em></p>
</div>
<div class="section" id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h2>
<p>Here we provide a brief introduction to the elements of this tutorial. The tutorial
explains how to setup <code class="docutils literal"><span class="pre">pygcam</span></code> and manage the GCAM workflow. A separate tutorial
will (eventually) be developed to describe how to use <code class="docutils literal"><span class="pre">pygcam</span></code> programmatically.</p>
<p>The steps involved in using <code class="docutils literal"><span class="pre">pygcam</span></code> are explained briefly here, and in more
detail in the sections that follow.</p>
<div class="section" id="install-pygcam">
<h3>1. Install pygcam<a class="headerlink" href="#install-pygcam" title="Permalink to this headline">¶</a></h3>
<p>Before using <code class="docutils literal"><span class="pre">pygcam</span></code>, you must install a Python 2.7 environment and then
install the <code class="docutils literal"><span class="pre">pygcam</span></code> package. See the <a class="reference internal" href="install.html"><em>Installation</em></a> page for details.
Windows users should also refer to <a class="reference internal" href="windows.html"><em>Using pygcam under Windows</em></a>.</p>
</div>
<div class="section" id="configure-pygcam">
<h3>2. Configure pygcam<a class="headerlink" href="#configure-pygcam" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal"><span class="pre">pygcam</span></code> scripts and libraries rely on a configuration file to:</p>
<blockquote>
<div><ul class="simple">
<li>define the location of essential and optional files,</li>
<li>allow the user to set defaults for many command-line arguments to scripts, and</li>
<li>define both global default and project-specific values for all parameters</li>
</ul>
</div></blockquote>
<p>See <a class="reference internal" href="#initial-configuration-label"><em>Initial Configuration</em></a> for how to set up
the configuration file for the first time, and the <a class="reference internal" href="config.html"><em>pygcam.config</em></a> page for
detailed information about the configuration file.</p>
</div>
<div class="section" id="define-the-project">
<h3>3. Define the project<a class="headerlink" href="#define-the-project" title="Permalink to this headline">¶</a></h3>
<p>Many of the features of the <a class="reference internal" href="gcamtool.html"><em>gt (GCAM tool)</em></a> script can be used directly without
setting up a project definition. However, the full workflow-management capabilities
of <code class="docutils literal"><span class="pre">pygcam</span></code> require an XML-based project definition file that describes:</p>
<ul class="simple">
<li>one or more projects that may have different workflow steps</li>
<li>one or more &#8220;scenario groups&#8221; that define a baseline and related policy scenarios</li>
<li>a set of steps to perform (e.g., run GCAM, query the database, compute differences
between scenario results, plot figures of scenario results and differences from
baselines.)</li>
<li>data required by some of the steps</li>
</ul>
<p>See <a class="reference internal" href="project-xml.html"><em>project.xml</em></a> for a detailed description of the file&#8217;s XML schema.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The <a class="reference internal" href="gcamtool.html#new-label"><em>new</em></a> sub-command of the <a class="reference internal" href="gcamtool.html"><em>gt (GCAM tool)</em></a> script can be used to create the
initial structure and files required for a new project, and optionally, insert
a section for the new project in the <code class="docutils literal"><span class="pre">$HOME/.pygcam.cfg</span></code> configuration file.</p>
</div>
</div>
<div class="section" id="setup-the-project-files">
<h3>4. Setup the project files<a class="headerlink" href="#setup-the-project-files" title="Permalink to this headline">¶</a></h3>
<p>The <a class="reference internal" href="gcamtool.html#setup-label"><em>setup</em></a> sub-command of the <a class="reference internal" href="gcamtool.html"><em>gt (GCAM tool)</em></a> script provides
support for modifying GCAM&#8217;s XML data files and configuration file according to
the needs of your project. See <a class="reference internal" href="setup.html"><em>GCAM XML-Setup</em></a> for details.</p>
<p>This is the only step of the pygcam workflow process that requires Python programming.
Work is underway to allow simple projects to be defined without requiring Python code.</p>
</div>
<div class="section" id="run-the-project">
<h3>5. Run the project<a class="headerlink" href="#run-the-project" title="Permalink to this headline">¶</a></h3>
<p>Project workflow is managed using the <a class="reference internal" href="gcamtool.html#run-label"><em>run</em></a> sub-command of the
<a class="reference internal" href="gcamtool.html"><em>gt (GCAM tool)</em></a> script, which reads the <a class="reference internal" href="project-xml.html"><em>project.xml</em></a> file to
understand the project setup, and offers numerous options allowing you
to choose which project, scenario group, or scenarios to operate on and which
steps to run.</p>
<hr class="docutils" />
</div>
</div>
<div class="section" id="initial-configuration">
<span id="initial-configuration-label"></span><h2>Initial configuration<a class="headerlink" href="#initial-configuration" title="Permalink to this headline">¶</a></h2>
<p>The <code class="docutils literal"><span class="pre">pygcam</span></code> package uses a configuration file called <code class="docutils literal"><span class="pre">.pygcam.cfg</span></code>, stored in
the user&#8217;s home directory, i.e., <code class="docutils literal"><span class="pre">$(HOME)/.pygcam.cfg</span></code>. When <code class="docutils literal"><span class="pre">gt</span></code> runs, it
checks whether this file exists. If the file is not found, it is created with all
available configuration parameters shown in comments (i.e., lines starting with &#8216;#&#8217;)
explaining their purpose and showing their default values. To uncomment a line,
simply remove the leading &#8216;#&#8217; character.</p>
<p>Edit the configuration file with any editor capable of
working with plain text&#8212;not a word-processor such as Word. You can use
the command <code class="docutils literal"><span class="pre">gt</span> <span class="pre">config</span> <span class="pre">-e</span></code> to invoke a system-appropriate editor on the
configuration file. See <a class="reference internal" href="config.html"><em>pygcam.config</em></a> for details.</p>
<div class="section" id="configuration-file-sections">
<h3>Configuration file sections<a class="headerlink" href="#configuration-file-sections" title="Permalink to this headline">¶</a></h3>
<p>The configuration file is divided into sections indicated by a name in square brackets.
All variable declarations following a section declaration, until the next section
declaration (if any) appear in the declared section. You can declare a section multiple
times to add new values to the section.
(See <a class="reference internal" href="#sample-config-label"><em>Sample Configuration File</em></a>, below.)</p>
<div class="section" id="project-sections">
<h4>Project sections<a class="headerlink" href="#project-sections" title="Permalink to this headline">¶</a></h4>
<p>Each project should have its own section. For example, to setup a project called, say,
&#8220;Paper1&#8221;, I would create the section <code class="docutils literal"><span class="pre">[Paper1]</span></code>. Following this, I would define variables
particular to this project, e.g., where the to find the files defining scenarios, queries,
and so on.</p>
</div>
<div class="section" id="default-section">
<h4>Default section<a class="headerlink" href="#default-section" title="Permalink to this headline">¶</a></h4>
<p>Default values are defined in the <code class="docutils literal"><span class="pre">[DEFAULT]</span></code> section. When <code class="docutils literal"><span class="pre">pygcam</span></code> requests the value
of a variable from a project section, the default value is returned if the variable is not
defined in the project section. Variables that you want to set uniformly for all of your
projects can be defined in the <code class="docutils literal"><span class="pre">[DEFAULT]</span></code> section.</p>
<p>All pre-defined <code class="docutils literal"><span class="pre">pygcam</span></code> variables are defined in the <code class="docutils literal"><span class="pre">[DEFAULT]</span></code> section,
allowing them to be overridden on a project-by-project basis.</p>
</div>
</div>
<div class="section" id="sample-configuration-file">
<span id="sample-config-label"></span><h3>Sample configuration file<a class="headerlink" href="#sample-configuration-file" title="Permalink to this headline">¶</a></h3>
<p>Below is a sample configuration file for a project called <code class="docutils literal"><span class="pre">Paper1</span></code>. The user has
created some (non-pygcam) variables prefixed by <code class="docutils literal"><span class="pre">User.</span></code>. The prefixes are merely a
convention to identify standard pygcam variables. For user-defined variables, use any
prefix desired, or none at all.</p>
<blockquote>
<div><div class="highlight-cfg"><div class="highlight"><pre><span class="k">[DEFAULT]</span>
<span class="na">GCAM.DefaultProject</span> <span class="o">=</span> <span class="s">Paper1</span>

<span class="na">User.RepoRoot</span>       <span class="o">=</span> <span class="s">%(Home)s/git-repo</span>
<span class="na">GCAM.SandboxRoot</span>    <span class="o">=</span> <span class="s">%(Home)s/ws</span>

<span class="na">GCAM.LogLevel</span>       <span class="o">=</span> <span class="s">INFO</span>
<span class="na">GCAM.ShowStackTrace</span> <span class="o">=</span> <span class="s">True</span>
<span class="na">GCAM.ModelInterfaceLogFile</span> <span class="o">=</span> <span class="s">%(Home)s/tmp/mi.log</span>
<span class="na">GCAM.UseVirtualBuffer</span> <span class="o">=</span> <span class="s">True</span>

<span class="na">GCAM.Root</span>           <span class="o">=</span> <span class="s">%(Home)s/GCAM</span>
<span class="na">GCAM.RefWorkspace</span>   <span class="o">=</span> <span class="s">%(GCAM.Current)s/Main_User_Workspace</span>
<span class="na">GCAM.ModelInterface</span> <span class="o">=</span> <span class="s">/pic/projects/GCAM/ModelInterface</span>
<span class="na">GCAM.JavaLibPath</span>    <span class="o">=</span> <span class="s">/pic/projects/GCAM/GCAM-libraries/lib/basex</span>
<span class="na">GCAM.OtherBatchArgs</span> <span class="o">=</span> <span class="s">-A my_account</span>

<span class="na">GCAM.QueryDir</span>  <span class="o">=</span> <span class="s">%(GCAM.ProjectDir)s/queries</span>
<span class="na">GCAM.QueryPath</span> <span class="o">=</span> <span class="s">%(GCAM.QueryDir)s</span>

<span class="c1"># Default location for query results</span>
<span class="na">GCAM.OutputDir</span> <span class="o">=</span> <span class="s">%(Home)s/ws/output</span>

<span class="c1"># Setup config files to not write extraneous files, so of which are very large</span>
<span class="na">GCAM.WriteDebugFile</span>     <span class="o">=</span> <span class="s">False</span>
<span class="na">GCAM.WritePrices</span>        <span class="o">=</span> <span class="s">False</span>
<span class="na">GCAM.WriteXmlOutputFile</span> <span class="o">=</span> <span class="s">False</span>
<span class="na">GCAM.WriteOutputCsv</span>     <span class="o">=</span> <span class="s">False</span>

<span class="k">[Paper1]</span>
<span class="na">GCAM.RegionMapFile</span> <span class="o">=</span> <span class="s">%(GCAM.ProjectDir)s/etc/Regions.txt</span>
</pre></div>
</div>
</div></blockquote>
</div>
</div>
<hr class="docutils" />
<div class="section" id="project-structure">
<h2>Project structure<a class="headerlink" href="#project-structure" title="Permalink to this headline">¶</a></h2>
<p>The <a class="reference internal" href="setup.html"><em>GCAM XML-Setup</em></a> system provides programmatic methods (i.e., Python functions) that
automatic common edits to GCAM XML input and configuration files. The output of the
setup system is thus a set of modified XML input and configuration files. These files
should not be edited manually as the changes will be overwritten the next time the
setup system is run.</p>
<p>The files defining a project are stored in the directory identified by the configuration
parameter <code class="docutils literal"><span class="pre">GCAM.XmlSrc</span></code>, which defaults to <code class="docutils literal"><span class="pre">%(GCAM.ProjectDir)s/xmlsrc</span></code>, i.e., the
directory <code class="docutils literal"><span class="pre">xmlsrc</span></code> within your project directory. Included under <code class="docutils literal"><span class="pre">xmlsrc</span></code> are</p>
<blockquote>
<div><ul class="simple">
<li>Custom XML files</li>
<li>A Python file that defines baseline and policy scenarios, and calls the setup
functions as needed to modify standard input files or included custom one.</li>
</ul>
</div></blockquote>
<p>The gcamtool <a class="reference internal" href="gcamtool.html#setup-label"><em>setup</em></a> sub-command loads the Python file and calls the
setup functions corresponding to the requires baseline and policy scenarios. This
modifies reference XML files and copies custom XML files to a directory identified by the
config parameter <code class="docutils literal"><span class="pre">GCAM.LocalXml</span></code>, which default to <code class="docutils literal"><span class="pre">%(GCAM.ProjectDir)s/local-xml</span></code>.
Dynamically generated constraints (i.e., those that depend on the output of the baseline
scenario) are written to the directory indicated by <code class="docutils literal"><span class="pre">GCAM.DynXml</span></code>, which defaults to
<code class="docutils literal"><span class="pre">%(GCAM.ProjectDir)s/dyn-xml</span></code>. See the <a class="reference internal" href="setup.html"><em>GCAM XML-Setup</em></a> page for further details.</p>
<p>N.B. a system for defining projects without writing any Python code is currently in development.</p>
</div>
<hr class="docutils" />
<div class="section" id="running-a-gcam-experiment">
<h2>Running a GCAM experiment<a class="headerlink" href="#running-a-gcam-experiment" title="Permalink to this headline">¶</a></h2>
<p>The basic GCAM experiment consists of a running a baseline scenario and one or more policy
scenarios that are compared to the baseline. In <code class="docutils literal"><span class="pre">pygcam</span></code>, the experiment is defined in
a <a class="reference internal" href="project-xml.html"><em>project.xml</em></a> file, the location of which is specified by the config parameter
<code class="docutils literal"><span class="pre">GCAM.ProjectXmlFile</span></code>, which defaults to <code class="docutils literal"><span class="pre">%(GCAM.ProjectDir)s/etc/project.xml</span></code>.</p>
<p>The <a class="reference internal" href="project-xml.html"><em>project.xml</em></a> file describes all the workflow steps required to setup, run, and
analyze the scenarios. The entire workflow or select steps can be run using the gcamtool
<cite>:ref: run &lt;run-label&gt;</cite> sub-command.</p>
<div class="section" id="run-time-structure">
<h3>Run-time structure<a class="headerlink" href="#run-time-structure" title="Permalink to this headline">¶</a></h3>
<p>In <code class="docutils literal"><span class="pre">pygcam</span></code>, each GCAM scenario is run in a separate copy of the standard GCAM
workspace. On Unix-like systems (and on Windows if
the user has adequate administrative privileges), the read-only files are symbolically
linked to the scenario workspace, avoiding copying of many megabytes of data.</p>
<p>Windows users lacking permission to create symbolic links should can the following
configuration parameter to cause copying rather than linking to occur:</p>
<div class="highlight-cfg"><div class="highlight"><pre><span class="na">GCAM.CopyAllFiles</span> <span class="o">=</span> <span class="s">True</span>
</pre></div>
</div>
<p>To avoid ambiguity between the reference GCAM workspace (i.e., <code class="docutils literal"><span class="pre">Main_User_Workspace</span></code>)
and the per-scenario, generated workspaces, we refer to the latter as <cite>sandboxes</cite>, which
is a computing term that refers to isolation areas in which programs are run to avoid
interactions with other programs.</p>
<p>The default <code class="docutils literal"><span class="pre">pygcam</span></code> structure assumes there is a directory under which you want all
sandboxes to be created. This is defined by the config parameter <code class="docutils literal"><span class="pre">GCAM.SandboxRoot</span></code>,
which defaults to <code class="docutils literal"><span class="pre">%(GCAM.Root)s/ws</span></code>. <code class="docutils literal"><span class="pre">GCAM.Root</span></code> in turn defaults to
<code class="docutils literal"><span class="pre">%(Home)s/GCAM</span></code>, thus the default sandbox root is <code class="docutils literal"><span class="pre">%(Home)s/GCAM/ws</span></code>. You can change
<code class="docutils literal"><span class="pre">GCAM.Root</span></code> or <code class="docutils literal"><span class="pre">GCAM.SandboxRoot</span></code> to any desired directory. The sandbox for an
individual project is defined by <code class="docutils literal"><span class="pre">GCAM.SandboxDir</span></code>, which defaults
to <code class="docutils literal"><span class="pre">%(GCAM.SandboxRoot)s/%(GCAM.ProjectName)s</span></code>.</p>
<p>With the project&#8217;s sandbox directory are the standard GCAM workspace folders, i.e.,
<code class="docutils literal"><span class="pre">input</span></code>, <code class="docutils literal"><span class="pre">libs</span></code>, <code class="docutils literal"><span class="pre">exe</span></code> (which are symbolic links when possible), and <code class="docutils literal"><span class="pre">output</span></code>,
which is always created locally in the sandbox to hold the GCAM output files.</p>
<p><em>Create a figure showing file structure</em></p>
</div>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="project-xml.html" class="btn btn-neutral float-right" title="project.xml" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="gcamtool.html" class="btn btn-neutral" title="gt (GCAM tool)" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016, Richard Plevin.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'0.1a1',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>